"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LList = void 0;
var Node = /** @class */ (function () {
    function Node(value, next) {
        this.value = value;
        this.next = next;
    }
    return Node;
}());
var LList = /** @class */ (function () {
    function LList(item) {
        this.root = null;
        this.tail = null;
        this.size = 0;
        if (Array.isArray(item)) {
            for (var i = 0; i < item.length; i++) {
                this.add(item[i]);
            }
        }
        else {
            for (var i = 0; i < item; i++) {
                this.add(undefined);
            }
        }
    }
    LList.prototype.add = function (value) {
        var node = new Node(value, null);
        if (this.tail) {
            this.tail.next = node;
        }
        if (!this.root) {
            this.root = node;
        }
        this.tail = node;
        this.size++;
    };
    LList.prototype.clear = function () {
        this.root = null;
        this.tail = null;
    };
    LList.prototype.contains = function (value) {
        var current = this.root;
        var index = 0;
        while (index <= this.size) {
            if (current.value === value) {
                return true;
            }
            if (current.value !== value) {
                if (current.next !== null) {
                    current = current.next;
                }
                else {
                    return false;
                }
            }
            index++;
        }
    };
    LList.prototype.get = function (index) {
        var counter = 0;
        var current = this.root;
        if (index < 0) {
            return -1;
        }
        if (index >= this.size) {
            return -1;
        }
        while (counter <= this.size) {
            if (counter === index) {
                return current.value;
            }
            current = current.next;
            counter++;
        }
    };
    LList.prototype.getSize = function () {
        var counter = 0;
        var current = this.root;
        while (current) {
            counter++;
            current = current.next;
        }
        return counter;
    };
    LList.prototype.halfReverse = function () {
        var arr = this.toArray();
        if (arr.length < 1) {
            return;
        }
        var half = Number((arr.length / 2).toFixed(0));
        var res = [];
        for (var i = half - 1; i < this.size; i++) {
            res[res.length] = arr[i];
        }
        for (var i = 0; i < half - 1; i++) {
            res[res.length] = arr[i];
        }
        this.clear();
        for (var i = 0; i < res.length; i++) {
            this.add(res[i]);
        }
    };
    LList.prototype.maxIndex = function () {
        var maxValue = this.root.value;
        var current = this.root;
        var counter = 0;
        var index = 0;
        while (current) {
            if (maxValue < current.value) {
                maxValue = current.value;
                index = counter;
            }
            counter++;
            current = current.next;
        }
        return index;
    };
    LList.prototype.maxValue = function () {
        var maxValue = this.root.value;
        var current = this.root;
        while (current) {
            if (maxValue < current.value) {
                maxValue = current.value;
            }
            current = current.next;
        }
        return maxValue;
    };
    LList.prototype.minIndex = function () {
        var minValue = this.root.value;
        var current = this.root;
        var counter = 0;
        var index = 0;
        while (current) {
            if (minValue > current.value) {
                minValue = current.value;
                index = counter;
            }
            counter++;
            current = current.next;
        }
        return index;
    };
    LList.prototype.minValue = function () {
        var minValue = this.root.value;
        var current = this.root;
        while (current) {
            if (minValue > current.value) {
                minValue = current.value;
            }
            current = current.next;
        }
        return minValue;
    };
    LList.prototype.print = function () {
        var current = this.root;
        while (current) {
            console.log(current.value);
            current = current.next;
        }
    };
    LList.prototype.remove = function (value) {
        var counter = 0;
        var current = this.root;
        var prev = null;
        while (counter < this.size) {
            if (current.value === value) {
                var result = current.value;
                if (current.next !== null) {
                    current.value = current.next.value;
                    current.next = current.next.next;
                }
                else {
                    if (prev !== null) {
                        prev.next = null;
                        this.tail = prev;
                    }
                    else {
                        this.root = null;
                        this.tail = null;
                    }
                }
                this.size--;
                if (this.size === 1) {
                    this.tail = null;
                }
                return result;
            }
            else {
                counter++;
                prev = current;
                current = current.next;
            }
        }
    };
    LList.prototype.removeAll = function (array) {
        var current = this.root;
        var prev = null;
        while (current) {
            if (array.includes(current.value)) {
                if (current.next !== null) {
                    current.value = current.next.value;
                    current.next = current.next.next;
                }
                else {
                    if (prev === null) {
                        this.root = null;
                        this.tail = null;
                        current = null;
                    }
                    if (prev !== null) {
                        prev.next = null;
                        current = prev;
                    }
                }
            }
            else {
                prev = current;
                current = current.next;
            }
        }
        this.size = this.getSize();
        if (this.size === 1) {
            this.tail = null;
        }
    };
    LList.prototype.retainAll = function (array) {
        var current = this.root;
        var prev = null;
        while (current) {
            if (!array.includes(current.value)) {
                if (current.next !== null) {
                    current.value = current.next.value;
                    current.next = current.next.next;
                }
                else {
                    if (prev === null) {
                        this.root = null;
                        this.tail = null;
                        current = null;
                    }
                    if (prev !== null) {
                        prev.next = null;
                        current = prev;
                    }
                }
            }
            else {
                prev = current;
                current = current.next;
            }
        }
        this.size = this.getSize();
        if (this.size === 1) {
            this.tail = null;
        }
    };
    LList.prototype.reverse = function () {
        var arr = this.toArray();
        if (arr.length < 1) {
            return;
        }
        this.clear();
        var result = [];
        for (var i = arr.length - 1; i >= 0; i--) {
            result[arr.length - 1 - i] = arr[i];
        }
        for (var i = 0; i < result.length; i++) {
            this.add(result[i]);
        }
    };
    LList.prototype.set = function (value, index) {
        var current = this.root;
        var counter = 0;
        while (counter < this.size) {
            if (counter === index) {
                current.value = value;
            }
            current = current.next;
            counter++;
        }
    };
    LList.prototype.sort = function () {
        var arr = doSort(this.toArray());
        function doSort(arr) {
            if (arr.length <= 1) {
                return arr;
            }
            var pivot = arr[0];
            var left = [];
            var right = [];
            for (var i = 1; i < arr.length; i++) {
                if (arr[i] < pivot) {
                    left[left.length] = arr[i];
                }
                else {
                    right[right.length] = arr[i];
                }
            }
            return doSort(left).concat(pivot, doSort(right));
        }
        this.clear();
        for (var i = 0; i < arr.length; i++) {
            this.add(arr[i]);
        }
    };
    LList.prototype.toArray = function () {
        var result = [];
        var current = this.root;
        while (current) {
            result[result.length] = current.value;
            current = current.next;
        }
        return result;
    };
    LList.prototype.toString = function () {
        var result = '';
        var current = this.root;
        while (current) {
            result = result + '' + current.value;
            current = current.next;
        }
        return result;
    };
    return LList;
}());
exports.LList = LList;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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O0lBQ0wsWUFBQztBQUFELENBbFhBLEFBa1hDLElBQUE7QUFsWFksc0JBQUsiLCJmaWxlIjoiTExpc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0lMaXN0fSBmcm9tIFwiLi90eXBlc1wiO1xyXG5cclxuY2xhc3MgTm9kZSB7XHJcbiAgICB2YWx1ZTogbnVtYmVyXHJcbiAgICBuZXh0OiBOb2RlXHJcblxyXG4gICAgY29uc3RydWN0b3IodmFsdWU6IG51bWJlciwgbmV4dD86IE5vZGUpIHtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5uZXh0ID0gbmV4dDtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIExMaXN0IGltcGxlbWVudHMgSUxpc3Qge1xyXG5cclxuICAgIHByaXZhdGUgcm9vdDogbnVsbCB8IE5vZGU7XHJcbiAgICBwcml2YXRlIHRhaWw6IG51bGwgfCBOb2RlO1xyXG4gICAgcHJpdmF0ZSBzaXplOiBudW1iZXI7XHJcblxyXG4gICAgY29uc3RydWN0b3IoaXRlbT86bnVtYmVyW10gfCBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnJvb3QgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudGFpbCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zaXplID0gMDtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtKSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkKGl0ZW1baV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW07IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGQodW5kZWZpbmVkKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFkZCh2YWx1ZSk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IG5vZGUgPSBuZXcgTm9kZSh2YWx1ZSwgbnVsbClcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudGFpbCkge1xyXG4gICAgICAgICAgICB0aGlzLnRhaWwubmV4dCA9IG5vZGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMucm9vdCkge1xyXG4gICAgICAgICAgICB0aGlzLnJvb3QgPSBub2RlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50YWlsID0gbm9kZTtcclxuICAgICAgICB0aGlzLnNpemUrK1xyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucm9vdCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50YWlsID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb250YWlucyh2YWx1ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5yb290O1xyXG4gICAgICAgIGxldCBpbmRleCA9IDA7XHJcblxyXG4gICAgICAgIHdoaWxlKGluZGV4IDw9IHRoaXMuc2l6ZSkge1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudC52YWx1ZSA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY3VycmVudC52YWx1ZSAhPT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Lm5leHQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5kZXgrK1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQoaW5kZXgpOiBudW1iZXIge1xyXG4gICAgICAgIGxldCBjb3VudGVyID0gMDtcclxuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMucm9vdFxyXG5cclxuICAgICAgICBpZiAoaW5kZXggPCAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtMVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGluZGV4ID49IHRoaXMuc2l6ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gLTFcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdoaWxlKGNvdW50ZXIgPD0gdGhpcy5zaXplKSB7XHJcbiAgICAgICAgICAgIGlmIChjb3VudGVyID09PSBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnQudmFsdWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0XHJcbiAgICAgICAgICAgIGNvdW50ZXIrK1xyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U2l6ZSgpOiBudW1iZXIge1xyXG4gICAgICAgIGxldCBjb3VudGVyID0gMDtcclxuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMucm9vdDtcclxuXHJcbiAgICAgICAgd2hpbGUoY3VycmVudCkge1xyXG4gICAgICAgICAgICBjb3VudGVyKytcclxuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQubmV4dFxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY291bnRlcjtcclxuICAgIH1cclxuXHJcbiAgICBoYWxmUmV2ZXJzZSgpOiB2b2lkIHtcclxuICAgICAgICBsZXQgYXJyID0gdGhpcy50b0FycmF5KClcclxuXHJcbiAgICAgICAgaWYgKGFyci5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaGFsZiA9IE51bWJlcigoYXJyLmxlbmd0aCAvIDIpLnRvRml4ZWQoMCkpO1xyXG4gICAgICAgIGxldCByZXMgPSBbXVxyXG4gICAgICAgIGZvciAobGV0IGkgPSBoYWxmIC0gMTsgaSA8IHRoaXMuc2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJlc1tyZXMubGVuZ3RoXSA9IGFycltpXVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhhbGYgLSAxOyBpKyspIHtcclxuICAgICAgICAgICAgcmVzW3Jlcy5sZW5ndGhdID0gYXJyW2ldXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2xlYXIoKVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLmFkZChyZXNbaV0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1heEluZGV4KCk6IG51bWJlciB7XHJcbiAgICAgICAgbGV0IG1heFZhbHVlID0gdGhpcy5yb290LnZhbHVlXHJcbiAgICAgICAgbGV0IGN1cnJlbnQgPSB0aGlzLnJvb3RcclxuICAgICAgICBsZXQgY291bnRlciA9IDA7XHJcbiAgICAgICAgbGV0IGluZGV4ID0gMDtcclxuXHJcbiAgICAgICAgd2hpbGUoY3VycmVudCkge1xyXG4gICAgICAgICAgICBpZiAobWF4VmFsdWUgPCBjdXJyZW50LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBtYXhWYWx1ZSA9IGN1cnJlbnQudmFsdWVcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gY291bnRlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb3VudGVyKytcclxuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQubmV4dFxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5kZXhcclxuICAgIH1cclxuXHJcbiAgICBtYXhWYWx1ZSgpOiBudW1iZXIge1xyXG4gICAgICAgIGxldCBtYXhWYWx1ZSA9IHRoaXMucm9vdC52YWx1ZVxyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5yb290O1xyXG5cclxuICAgICAgICB3aGlsZShjdXJyZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChtYXhWYWx1ZSA8IGN1cnJlbnQudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIG1heFZhbHVlID0gY3VycmVudC52YWx1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHRcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1heFZhbHVlXHJcbiAgICB9XHJcblxyXG4gICAgbWluSW5kZXgoKTogbnVtYmVyIHtcclxuICAgICAgICBsZXQgbWluVmFsdWUgPSB0aGlzLnJvb3QudmFsdWVcclxuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMucm9vdFxyXG4gICAgICAgIGxldCBjb3VudGVyID0gMDtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG5cclxuICAgICAgICB3aGlsZShjdXJyZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChtaW5WYWx1ZSA+IGN1cnJlbnQudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIG1pblZhbHVlID0gY3VycmVudC52YWx1ZVxyXG4gICAgICAgICAgICAgICAgaW5kZXggPSBjb3VudGVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvdW50ZXIrK1xyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbmRleFxyXG4gICAgfVxyXG5cclxuICAgIG1pblZhbHVlKCk6IG51bWJlciB7XHJcbiAgICAgICAgbGV0IG1pblZhbHVlID0gdGhpcy5yb290LnZhbHVlXHJcbiAgICAgICAgbGV0IGN1cnJlbnQgPSB0aGlzLnJvb3RcclxuXHJcbiAgICAgICAgd2hpbGUoY3VycmVudCkge1xyXG4gICAgICAgICAgICBpZiAobWluVmFsdWUgPiBjdXJyZW50LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBtaW5WYWx1ZSA9IGN1cnJlbnQudmFsdWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtaW5WYWx1ZVxyXG4gICAgfVxyXG5cclxuICAgIHByaW50KCk6IHZvaWQge1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5yb290O1xyXG5cclxuICAgICAgICB3aGlsZShjdXJyZW50KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGN1cnJlbnQudmFsdWUpXHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHRcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZSh2YWx1ZSk6IG51bWJlciB7XHJcbiAgICAgICAgbGV0IGNvdW50ZXIgPSAwO1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5yb290O1xyXG4gICAgICAgIGxldCBwcmV2ID0gbnVsbDtcclxuXHJcbiAgICAgICAgd2hpbGUoY291bnRlciA8IHRoaXMuc2l6ZSkge1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQudmFsdWUgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjdXJyZW50LnZhbHVlXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubmV4dCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQudmFsdWUgPSBjdXJyZW50Lm5leHQudmFsdWVcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Lm5leHQgPSBjdXJyZW50Lm5leHQubmV4dFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXYgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJldi5uZXh0ID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhaWwgPSBwcmV2XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YWlsID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNpemUtLVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2l6ZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFpbCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudGVyKytcclxuICAgICAgICAgICAgICAgIHByZXYgPSBjdXJyZW50O1xyXG4gICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQubmV4dFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVBbGwoYXJyYXkpOiB2b2lkIHtcclxuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMucm9vdDtcclxuICAgICAgICBsZXQgcHJldiA9IG51bGw7XHJcblxyXG4gICAgICAgIHdoaWxlKGN1cnJlbnQpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChhcnJheS5pbmNsdWRlcyhjdXJyZW50LnZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubmV4dCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQudmFsdWUgPSBjdXJyZW50Lm5leHQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudC5uZXh0ID0gY3VycmVudC5uZXh0Lm5leHRcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXYgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YWlsID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJldiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2Lm5leHQgPSBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBwcmV2XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IGN1cnJlbnRcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNpemUgPSB0aGlzLmdldFNpemUoKVxyXG5cclxuICAgICAgICBpZiAodGhpcy5zaXplID09PSAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFpbCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldGFpbkFsbChhcnJheSk6IHZvaWQge1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5yb290O1xyXG4gICAgICAgIGxldCBwcmV2ID0gbnVsbDtcclxuXHJcbiAgICAgICAgd2hpbGUoY3VycmVudCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKCFhcnJheS5pbmNsdWRlcyhjdXJyZW50LnZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubmV4dCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQudmFsdWUgPSBjdXJyZW50Lm5leHQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudC5uZXh0ID0gY3VycmVudC5uZXh0Lm5leHRcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXYgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YWlsID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJldiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2Lm5leHQgPSBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBwcmV2XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcHJldiA9IGN1cnJlbnRcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNpemUgPSB0aGlzLmdldFNpemUoKVxyXG5cclxuICAgICAgICBpZiAodGhpcy5zaXplID09PSAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFpbCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldmVyc2UoKTogdm9pZCB7XHJcbiAgICAgICAgbGV0IGFyciA9IHRoaXMudG9BcnJheSgpXHJcblxyXG4gICAgICAgIGlmIChhcnIubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXIoKVxyXG4gICAgICAgIGxldCByZXN1bHQgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gYXJyLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFthcnIubGVuZ3RoIC0gMSAtIGldID0gYXJyW2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLmFkZChyZXN1bHRbaV0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldCh2YWx1ZSwgaW5kZXgpOiB2b2lkIHtcclxuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMucm9vdDtcclxuICAgICAgICBsZXQgY291bnRlciA9IDA7XHJcblxyXG4gICAgICAgIHdoaWxlKGNvdW50ZXIgPCB0aGlzLnNpemUpIHtcclxuICAgICAgICAgICAgaWYgKGNvdW50ZXIgPT09IGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50LnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHQ7XHJcbiAgICAgICAgICAgIGNvdW50ZXIrKztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc29ydCgpOiB2b2lkIHtcclxuXHJcbiAgICAgICAgbGV0IGFycjogbnVtYmVyW10gPSBkb1NvcnQodGhpcy50b0FycmF5KCkpXHJcbiAgICAgICAgZnVuY3Rpb24gZG9Tb3J0IChhcnIpOiBudW1iZXJbXSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJyXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBwaXZvdCA9IGFyclswXTtcclxuICAgICAgICAgICAgbGV0IGxlZnQgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHJpZ2h0ID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXJyW2ldIDwgcGl2b3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0W2xlZnQubGVuZ3RoXSA9IGFycltpXVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByaWdodFtyaWdodC5sZW5ndGhdID0gYXJyW2ldXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGRvU29ydChsZWZ0KS5jb25jYXQocGl2b3QsIGRvU29ydChyaWdodCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNsZWFyKClcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5hZGQoYXJyW2ldKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgdG9BcnJheSgpOiBudW1iZXJbXSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW11cclxuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMucm9vdFxyXG4gICAgICAgIHdoaWxlKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gY3VycmVudC52YWx1ZVxyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgIH1cclxuXHJcbiAgICB0b1N0cmluZygpOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSAnJ1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5yb290XHJcbiAgICAgICAgd2hpbGUoY3VycmVudCkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgKyAnJyArIGN1cnJlbnQudmFsdWVcclxuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQubmV4dFxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICB9XHJcbn0iXSwic291cmNlUm9vdCI6Ii4uIn0=
